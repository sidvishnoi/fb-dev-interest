fbDevInterest.clearBlacklist=function(){for(const e of this._blacklist){const t=this.ALL_GROUPS.indexOf(parseInt(e,10));t>-1&&this.ALL_GROUPS.splice(t,1)}try{let e=document.querySelector("meta[property='al:ios:url']").content.match(/id=(\d*)/)[1];e=parseInt(e,10);const t=this.ALL_GROUPS.indexOf(e);t>-1&&this.ALL_GROUPS.splice(t,1),this.ALL_GROUPS.unshift(e)}catch(e){}},fbDevInterest.createPlaceholder=function(){const e=document.createElement("div");return e.classList.add(..."_3-u2 mbm _2iwp _4-u8".split(" ")),e.innerHTML='<div class="_2iwo _3f3l" data-testid="fbfeed_placeholder_story"><div class="_2iwq"><div class="_1enb"></div><div class="_2iwr"></div><div class="_2iws"></div><div class="_2iwt"></div><div class="_2iwu"></div><div class="_2iwv"></div><div class="_2iww"></div><div class="_2iwx"></div><div class="_2iwy"></div><div class="_2iwz"></div><div class="_2iw-"></div><div class="_2iw_"></div><div class="_2ix0"></div></div></div>',e},fbDevInterest.BASE_API_URL=`https://graph.facebook.com/v2.11/GROUPID/?&access_token=${fbDevInterest._apiKey}&fields=name,id,feed{message,id,name,from,permalink_url,full_picture,link,created_time}`,fbDevInterest.getGroupId={},fbDevInterest.getGroupId=function(){const e=this;let t=-1;return function*(){for(;;)yield e.ALL_GROUPS[++t%e.ALL_GROUPS.length]}()},fbDevInterest.parent=document.querySelector("#pagelet_group_mall"),fbDevInterest.state={},fbDevInterest.findMatchedKeywords=function(e){if(0===this._keywords.size)return[[0,0]];const t=e.toLowerCase(),s=[];for(const e of this._keywords){const n=new RegExp(`(?:^|\\b)(${e.replace(/\s\s+/g,"\\s*")})(?=\\b|$)`),a=t.match(n);a&&s.push([a.index,a[0].length])}return s.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:e[1]<t[1]?1:e[1]>t[1]?-1:0})},fbDevInterest.highlightMatches=function(e,t){let s,n="",a=0;const i=new Set;for(let d=0;d<t.length;++d){s=0===d?0:t[d-1][0]+t[d-1][1];const[r,o]=t[d];i.has(r)?a=t[d-1][0]+t[d-1][1]:(i.add(r),n+=`${e.substring(0!==a?a:s,r)}<mark>${e.substring(r,r+o)}</mark>`,a=0)}const d=t[t.length-1];return n+=e.substring(d[0]+d[1])},fbDevInterest.splitPostBody=function(e){const t=e.split("</p>");if(t.length<6)return e;const s=t.slice(0,6).join("</p>"),n=t.slice(6).join("</p>"),a=Math.random().toString().replace(".","");return`<div id="id_${a}" class="text_exposed_root">${s}<span class="text_exposed_hide">...</span><div class="text_exposed_show">${n}</div><span class="text_exposed_hide"> <span class="text_exposed_link"><a class="see_more_link" onclick="var func = function(e) { e.preventDefault(); }; var parent = Parent.byClass(this, 'text_exposed_root'); if (parent && parent.getAttribute('id') == 'id_${a}') { CSS.addClass(parent, 'text_exposed'); Arbiter.inform('reflow'); }; func(event); "><span class="see_more_link_inner">See more</span></a></span></span></div>`},fbDevInterest.showComments=function(e,t){const s=this,n=function(e,t){const n=new Date(e.created_time),a=`\n      <div class="_3b-9">\n        <div>\n          <div direction="left" class="clearfix">\n            <div class="_ohe lfloat"><a target="_blank" href="https://www.facebook.com/${e.from.id}" class="img _8o _8s UFIImageBlockImage" tabindex="-1" aria-hidden="true"><img alt="${e.from.name}" class="img UFIActorImage _54ru img" src="https://graph.facebook.com/${e.from.id}/picture?&access_token=${s._apiKey}&type=normal"></a></div>\n            <div class="">\n              <div class="UFIImageBlockContent _42ef">\n                <div class="UFICommentContentBlock">\n                  <div class="UFICommentContent">\n                    <span class="UFICommentActorAndBody">\n                      <span class=""><a class=" UFICommentActorName" target="_blank" href="https://www.facebook.com/${e.from.id}">${e.from.name}</a></span>\n                      <span class="UFICommentBody"><span>${e.message.linkify()}</span></span>\n                    </span>\n                    <div class="fsm fwn fcg UFICommentActions"><span class="_6a _3-me">\n                    </span><a class="uiLinkSubtle" href="${e.permalink_url}" target="_blank"><abbr class="livetimestamp" title="${n.format("dddd, d MMMM yyyy at hh:mm")}" data-shorten="true">${n.format("d MMMM at HH:mm")}</abbr></a></span></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `,i=document.createElement("div");return i.classList.add(..."UFIRow _48ph _48pi UFIComment _4oep".split(" ")),i.style.borderTop="none",i.innerHTML=a,t.appendChild(i),i},a=function(e,t){const n=new Date(e.created_time),a=`\n      <div class="_3b-9">\n        <div>\n          <div direction="left" class="clearfix">\n            <div class="_ohe lfloat">\n              <a target="_blank" href="https://www.facebook.com/${e.from.id}" class="img _8o _8s UFIImageBlockImage" tabindex="-1" aria-hidden="true"><img alt="${e.from.name}" class="img UFIActorImage _54ru img" src="https://graph.facebook.com/${e.from.id}/picture?&access_token=${s._apiKey}&type=normal"></a>\n            </div>\n            <div class="">\n              <div class="UFIImageBlockContent _42ef">\n                <div class="UFICommentContentBlock">\n                  <div class="UFICommentContent">\n                    <span class="UFICommentActorAndBody">\n                      <span class=""><a class=" UFICommentActorName" target="_blank" href="https://www.facebook.com/${e.from.id}">${e.from.name}</a></span>\n                      <span class="UFICommentBody"><span>${e.message.linkify()}</span></span>\n                    </span>\n                    <div class="fsm fwn fcg UFICommentActions"><span class="_6a _3-me">\n                    </span><a class="uiLinkSubtle" href="${e.permalink_url}" target="_blank"><abbr class="livetimestamp" title="${n.format("dddd, d MMMM yyyy at hh:mm")}" data-shorten="true">${n.format("d MMMM at HH:mm")}</abbr></a></span></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `,i=document.createElement("div");return i.classList.add(..."UFIRow _48ph _48pi _4204 UFIComment _4oep".split(" ")),i.style.borderLeftWidth="2px",i.innerHTML=a,t.appendChild(i),i};if(document.getElementById(`comment_trigger_${e.id}`).innerHTML="View all comments",e.comments)for(const s of e.comments.data){n(s,t);const e=document.createElement("div");if(e.classList.add("UFIReplyList"),t.appendChild(e),s.comments)for(const t of s.comments.data){a(t,e)}}else document.getElementById(`comment_trigger_${e.id}`).innerHTML="No comments yet."},fbDevInterest.getComments=function(e,t){const s=function(t,s){const n=`\n      <div class="UFIRow UFIPagerRow _4oep _48pi _4204">\n        <div direction="right" class="clearfix">\n          <div class="_ohf rfloat"></div>\n          <div class=""><a class="UFIPagerLink" id="comment_trigger_${t}" target="_blank" href="https://facebook.com/${t}" role="button">View all comments</a></div>\n        </div>\n      </div>\n    `,a=document.createElement("form");a.classList.add("commentable_item"),s.appendChild(a);const i=document.createElement("div");i.classList.add(..."uiUfi UFIContainer _5pc9 _5vsj _5v9k".split(" ")),a.appendChild(i);const d=document.createElement("div");d.classList.add("UFIList"),d.innerHTML='<h6 class="accessible_elem">Comments</h6>',i.appendChild(d);const r=document.createElement("div");r.classList.add(..."_3b-9 _j6a".split(" ")),d.appendChild(r);const o=document.createElement("div");return o.innerHTML=n,r.appendChild(o),document.getElementById(`comment_trigger_${e}`).innerHTML='View all comments <span class="mls img _55ym _55yn _55yo" role="progressbar" aria-valuetext="Loading..." aria-busy="true" aria-valuemin="0" aria-valuemax="100"></span>',o}(e,t),n=`https://graph.facebook.com/v2.11/${e}/?&access_token=${fbDevInterest._apiKey}&fields=comments{from,permalink_url,message,created_time,comments{from,permalink_url,message,created_time}},permalink_url`;fetch(n).then(e=>e.json()).then(e=>this.showComments(e,s)).catch(t=>document.getElementById(`comment_trigger_${e}`).innerHTML="Try again")},fbDevInterest.showPostButtons=function(e,t){function s(){n.getComments(e.id,t),this.removeEventListener("click",s)}const n=this,a=document.createElement("div");a.classList.add(..."_sa_ _gsd _fgm _5vsi _192z".split(" "));const i=document.createElement("div");a.classList.add("_37uu"),a.appendChild(i);const d=document.createElement("div");i.appendChild(d);const r=document.createElement("div");r.classList.add("_57w"),d.appendChild(r);const o=document.createElement("div");o.classList.add(..."_3399 _a7s _20h6 _610i _125r clearfix _zw3".split(" ")),r.appendChild(o);const c=document.createElement("div");c.classList.add("_524d"),o.appendChild(c);const l=document.createElement("div");l.classList.add("_42nr"),c.appendChild(l);const m=document.createElement("span");m.classList.add("_1mto"),l.appendChild(m);const p=document.createElement("div");p.classList.add(..."_khz _4sz1".split(" ")),m.appendChild(p);const _=document.createElement("a");_.classList.add(..."UFILikeLink _4x9- _4x9_ _48-k".split(" ")),_.href=e.permalink_url,_.setAttribute("target","_blank"),_.innerText="Like",p.appendChild(_);const u=document.createElement("span");u.classList.add("_1mto"),l.appendChild(u);const v=document.createElement("div");v.classList.add(..."_6a _15-7 _3h-u".split(" ")),u.appendChild(v);const f=document.createElement("a");f.classList.add(..."comment_link _5yxe".split(" ")),f.href="#",f.setAttribute("role","button"),f.innerText="Comment",f.addEventListener("click",s),v.appendChild(f);const h=document.createElement("span");h.classList.add("_1mto"),l.appendChild(h);const g=document.createElement("div");g.classList.add("_27de"),h.appendChild(g);const b=document.createElement("a");return b.classList.add(..."share_action_link _5f9b".split(" ")),b.href=e.permalink_url,b.setAttribute("target","_blank"),b.innerText="Share",g.appendChild(b),t.appendChild(a),a},fbDevInterest.showPost=function(e,t){if(!e.message)return;const s=this.findMatchedKeywords(e.message);if(0===s.length)return;this._highlightMatches&&(e.message=this.highlightMatches(e.message,s)),e.message=e.message.replace(/\n/g,"</p><p>").linkify(),e.link&&!e.full_picture&&(e.message=`${e.message} </p><p>[<b>LINK:</b> <a href="${e.link}" target="_blank">${e.link}</a>]`),e.message=this.splitPostBody(e.message);const n=new Date(e.created_time),a=e.full_picture&&!e.full_picture.includes("//external.")?`<div class="_3x-2"><div><div class="mtm"><div><a class="_4-eo _2t9n _50z9" ajaxify="${e.link}&player_origin=groups" data-ploi="${e.full_picture}&player_origin=groups" href="${e.link}" data-render-location="group"><div class="uiScaledImageContainer _517g"><img class="scaledImageFitWidth img" src="${e.full_picture}"></div></a></div></div></div></div>`:"",i=`\n    <div class="_3ccb">\n      <div></div>\n      <div class="_5pcr userContentWrapper">\n        <div class="_1dwg _1w_m _q7o">\n          <h5 class="_5pbw fwb">\n            <a target="_blank" href="https://www.facebook.com/${e.from.id}">${e.from.name}</a>\n    ‎         ▶\n            <a target="_blank" href="https://www.facebook.com/${t.id}">${t.name}</a>\n          </h5>\n          <div class="_5pcp _5lel _232_"><span class="_5paw _14zs"><a class="_3e_2 _14zr" href="#"></a></span><span role="presentation" aria-hidden="true"> · </span><span class="fsm fwn fcg"><a class="_5pcq" href="${e.permalink_url}" target="_blank"><abbr title="${n.format("dddd, d MMMM yyyy at HH:mm")}" class="_5ptz"><span class="timestampContent">${n.format("d MMMM at HH:mm")}</span></abbr>\n            </a>\n            </span>\n          </div>\n          <div class="_5pbx userContent _22jv _3576">\n            <p>${e.message}</p>\n            ${a}\n          </div>\n          <div></div>\n        </div>\n      </div>\n    </div>\n    `,d=document.createElement("div");d.classList.add(..."_4-u2 mbm _4mrt _5jmm _5pat _5v3q _4-u8".split(" ")),d.id=`mall_post_${e.id}:6:0`,d.innerHTML=i;const r=document.querySelector("._3-u2.mbm._2iwp._4-u8");r?this.parent.replaceChild(d,r):this.parent.appendChild(d),this.showPostButtons(e,d)},fbDevInterest.getGroupFeed=function(e){let t=this.BASE_API_URL.replace("GROUPID",e.groupId);const s=this.state[e.groupId];s&&s.nextPageUrl&&(t=s.nextPageUrl),fetch(t).then(e=>e.json()).then(s=>{if(s.error)throw s.error;if(!s.feed){if(!Array.isArray(s.data))throw new Error(`failed to fetch: ${t}`);s.feed=s}this.state[e.groupId]=this.state[e.groupId]||{name:s.name},this.state[e.groupId].nextPageUrl=s.feed.paging.next;for(const t of s.feed.data)this.showPost(t,{name:this.state[e.groupId].name,id:e.groupId});this.showPostsOnScroll()}).catch(e=>{if(console.error(e),e){const t=document.createElement("div");t.classList.add(..."_4-u2 mbm _4mrt _5jmm _5pat _5v3q _4-u8".split(" ")),t.innerHTML=`<div class="_3ccb"><div class="_5pcr userContentWrapper"><div class="_1dwg _1w_m _q7o"><div class="_5pbx userContent _22jv _3576">\n          <pre>${JSON.stringify(e,null,2)}</pre>\n          </div></div></div></div>`,t.style.color="red",this.parent.appendChild(t)}})},fbDevInterest.clearPosts=function(){const e=e=>Array.from(e).forEach(e=>e.remove());e(document.querySelectorAll("._4mrt._5jmm._5pat._5v3q._4-u8")),e(document.querySelectorAll("._5umn")),e(document.querySelectorAll("._4wcq")),window.addEventListener("scroll",e=>e.stopPropagation(),!0)},fbDevInterest.getFeed=function(){this.clearBlacklist(),this.getGroupId=this.getGroupId(),this.clearPosts();for(let e=0;e<5;++e)this.parent.appendChild(this.createPlaceholder());scrollToItem(this.parent),this.getGroupFeed({groupId:this.getGroupId.next().value})},fbDevInterest.showPostsOnScroll=function(){const e=this,t=document.querySelectorAll("._4mrt._5jmm._5pat._5v3q._4-u8"),s=t[t.length-1],n=function(t){if(!s)return e.getGroupFeed({groupId:e.getGroupId.next().value});if(isScrolledIntoView(s)){window.removeEventListener("scroll",n,!0);const t=e.createPlaceholder();for(let s=0;s<5;++s)e.parent.appendChild(t);e.getGroupFeed({groupId:e.getGroupId.next().value})}};window.addEventListener("scroll",n,!0)};